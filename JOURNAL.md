<!--
  ===================    !!READ THIS NOTICE!!   ====================
  DO NOT edit this file manually. Your changes WILL BE OVERWRITTEN!
  This journal is auto generated and updated by Hack Club Blueprint.
  To edit this file, please edit your journal entries on Blueprint.
  ==================================================================
-->

This is my journal of the design and building process of **nixieclock**.  
You can view this journal in more detail on **Hack Club Blueprint** [here](https://blueprint.hackclub.com/projects/101).


## 10/3/2025 - Did lots of planning  

Okay, so. the first part of any project is to plan! I like to use as few breakouts as possible for space efficiency/general coolness. Which is something you should keep in mind.

# Micro-controllers
Okay, so I had a few options for micro-controllers. The common options are:
- ESP32
- ESP8266
- RP2040
- RP2350

I quickly discounted the RP2350 for it being more expensive and harder to use, but not giving any benefit. I then discounted the ESP\* series of chips due to general inexperience with the platform, but also the power inefficiency of them. the reduced part requirement would have been nice though.

# Power
I very quickly chose USB PD for this project, whilst this is more expensive than a traditional 12v supply, and harder than a 5v supply. It gives me slightly more flexibility, additionally. PD means that I can use 20V supplies, which should put the boost converter in less strain.
I did consider a step-down converter though, since the UK runs at 230V (tubes run at 170v) but I discounted this for a mix of higher voltages and needing to handle AC/DC conversion.

# The Tubes!
I went for 6x IN-16 tubes because I think they are the smallest/cheapest tubes that would look good standing up. It also happens that they are easily purchasable on eBay.

# Tube Controller
I thought long and hard about this. I had 2 real options:
- Use the original driver IC's (pros: Simpler to use, Cons: Only avaliable on eBay, Expensive, Need 1 per tube)
- Use Microchips's HV5122 / HV5222 (pros: Harder to use, Cons: Kinda hard to get, Only need 1, Harder to solder

In the end, I chose to use Microchip's HV5122 for the simplified wiring, despite it not being avaliable at LCSC (where most of my parts are coming from) but this could change later as I re-evaluate the ebay listings closer to the time.

# A block diagram
Who doesn't like a diagram :P
![image.png](https://blueprint.hackclub.com/user-attachments/blobs/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MjM3LCJwdXIiOiJibG9iX2lkIn19--b9577817b0fae970d7104fd4274ce0365d2db253/image.png)
  

## 10/5/2025 - Designed the RP2040 Schematic  

So, Since we are building around the RP2040, the first step is to build that onto the PCB.
I didn't want to use the pico W for space constraints, and I think doing it onboard makes it a more complex and interesting project.

Step 1 was to place the actual RP2040 electronics on the board, for this I used the example schematic as a base.

### Modifications to the base
#### Voltage Regulator
Since the USB PD voltage is at ~~20v~~ 12v, we need a regulator that can regulate that down to 3V3 (I wanted 20v but I couldn't get a regulator for that, so we are going with 12v. Shouldn't make too much of a difference)

The typical circuit looks like this:
![image.png](https://blueprint.hackclub.com/user-attachments/blobs/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NTIxLCJwdXIiOiJibG9iX2lkIn19--5822e72860b8a94c746378e1b8f0c6769f49aaf7/image.png)

Basically just different capacitor values :D

#### USB PD
I went for the HUSB238 series of PD chip, because they are easily accessible. Additionally they are often used by Adafruit, so there's a wide selection of examples.

And, about an hour and a half later I have this monstrosity.
![image.png](https://blueprint.hackclub.com/user-attachments/blobs/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NTMxLCJwdXIiOiJibG9iX2lkIn19--8bc1772bb541f48ed6dd8d7d892846d7cb8ea956/image.png)

# Somewhat finished Microcontroller core
After another (heavily disrupted) half an hour of copying and modifying the design, I got left with this:
![image.png](https://blueprint.hackclub.com/user-attachments/blobs/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NTg0LCJwdXIiOiJibG9iX2lkIn19--162039143a4e24dbdc9ad6b884627c0d2c08efa9/image.png)

You'll notice there's no GPIO connected yet, or wireless stuff or even a buzzer but those will come next time. I want to work on the high voltage power stuff now :P


  

## 10/8/2025 - Designed the High Voltage generator  

I had a few goals in mind for the HV generation:
- Be low part count
- Be Safe
- Be compact

To achieve the safety aspects of the design, I set a few hard rules.
- Anything higher than 12v stays to one side of the board, behind the tubes and opposite to the controls.
- A 3D printed cover would go on-top of the generation components
- I would build in a voltmeter controlled by the RP2040 so that the tubes are only electrified if safe & stable if it's possible with few parts.

I chose to base my boost converter on [this tutorial](http://electronoobs.com/eng_circuitos_tut57.php) as it appears relatively simple, and can output enough current.

If we look at the [datasheet for the MAX1771ESA+T](https://www.analog.com/media/en/technical-documentation/data-sheets/MAX1771.pdf)

We are particularly interested in the voltage regulator that connects to the FB pin, as this sets the output voltage.

![image.png](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MTAzMCwicHVyIjoiYmxvYl9pZCJ9fQ==--5ef52a5fc4731032e71ce3e75b7ad75d839dcffa/image.png)

R2 = (10000)((170 / 1.5v) - 1)
Set R1 to 10k (to give us an easy number, so R2 = 1123333.333Ω = 1.123333 MΩ
If we set R2 to 13k, R2 = 1460333.333Ω = 1.460333 MΩ

But if I want to use a 1.3M ohm resistor for R2 (because it's easy accessible on LCSC) I need to solve the equation for R1:
R1 ​= (R2 / (1.5/ 170) ​− 1)
R1 = (1300000 / (1.5 / 170) - 1)
R1 = 11572.7003Ω = 11.5727 kΩ, so to get as close as possible, I'll put an 11k potentiometer on R1
![image.png](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MTAzNiwicHVyIjoiYmxvYl9pZCJ9fQ==--da70603563e31165d69ab358a394fcf4651e7090/image.png)

I did have to scrap the voltmeter though, as it would have complicated the circuitry with voltage dividers and such, and had the potential to damage the rp2040 if my voltage divider didn't bring it down into range of the pico's ADC.


  

## 10/11/2025 - Designed the Tube Schematic  

I've chosen to use the [nixies.us](https://github.com/judge2005/Eagle-and-KiCAD-Nixie-Libs) library for the headers. These are well tested and it saves me trying to read placement information from an old soviet datasheet. This is included as a git submodule (at nixieclock/nixies.us).

I started on the schematic by placing down all 6 tubes.
![image.png](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MTU4MiwicHVyIjoiYmxvYl9pZCJ9fQ==--36c5be74b7f5afed9146c1ed26e2000a937396b7/image.png)

As I previously discussed, I want use the HV5122 series of controller, However I have slight sourcing issues.
[LCSC](https://www.lcsc.com/search?q=HV5122&s_z=n_HV5122) list 2 options, but they are both out of stock and cost $15+.
[Digikey](https://www.digikey.co.uk/en/products/filter/logic/shift-registers/712?s=N4IgTCBcDaIBIDUCsBGMEC6BfIA) have them in stock but they cost 5 GBP, Plus the flatrate 12 GBP for shipping (as I wouldn't be able to justify shipping the rest of the BOM from them) for a total of 17GBP ($17.46).
And [Mouser](https://www.mouser.co.uk/ProductDetail/689-HV5122PJ-G) have it for $27.32 including shipping

However, after reading the datasheet some more, I have realised that using this chip would also introduce more complexity as
![image.png](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MTU4MywicHVyIjoiYmxvYl9pZCJ9fQ==--d16545ae2dc239e6ae7defea72172808c4594294/image.png)

Which means I also need a level shifter on the serial inputs. I chose to use the Digikey footprint/symbol for the HV5122

With the HV5122's in place, the schematic looks like this:
![image.png](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MTU4NSwicHVyIjoiYmxvYl9pZCJ9fQ==--38ea3973e9c134b1bd1c08c1fb48e3657e1ef06b/image.png)

# Level Shifter,
I initially looked at the 74LVC125, however quickly realized that it can't shift up to 12v.

I'm pausing my work here while I wait for someone to help me find a volta


  

